# 2025-12-22

- Moved shared dataset root to `/Users/byron/projects/data/immunos_data` and updated docs.
- Added `docs/training.md` and linked it from `README.md`.
- Added `IMMUNOS_DATA_ROOT` support and `--db-path` for NegSel persistence; `save_to_db` now creates tables.
- Training runs:
  - Code security scanner: `PYTHONPATH=src python3 examples/code_security_scanner/scanner.py`
  - NegSel: `PYTHONPATH=src python3 src/immunos_mcp/algorithms/negsel.py train /Users/byron/projects/immunos-mcp/src --num-detectors 20 --r-self 0.85 --db-path .immunos/db/immunos.db`
- Added hallucination and network training CLIs under `src/immunos_mcp/training/`.
- Added save/load support for BCell, NK, and Enhanced NK, plus orchestrator flags `--bcell-state` and `--nk-state`.
- Training runs saved:
  - Hallucination: `.immunos/agents/hallucination_bcell.json`, `.immunos/agents/hallucination_nk.json`
  - Network: `.immunos/agents/network_nk_enhanced.json`
- Added `SimpleTextEmbedder` and used it for hallucination training; NK detectors now generate with `--nk-threshold 0.85`.
- Added domain routing via `src/immunos_mcp/config/agent_routes.json` and orchestrator `--domain` support.
- Added SciFact research trainer (`src/immunos_mcp/training/research_trainer.py`) and docs.
- Downloaded SciFact dataset into `/Users/byron/projects/data/immunos_data/research/scifact/data` and fixed nested `data/data` extraction.
- Trained research agents with SciFact and saved `.immunos/agents/research_bcell.json` + `.immunos/agents/research_nk.json`.
- Updated IMMUNOS dashboard monitor with an Orchestrator Map tab, live agent network canvas, and refreshed domain descriptions.
- Added orchestrator map tab updates: simulate detection button, domain stats loading, and live agent graph in the monitor dashboard.
- Added API endpoints for domain stats and event ingestion/simulation; orchestrator can emit events via `/api/events/detection`.
- Restarted dashboard server on port 5001.
- Added domain stats API, simulation endpoint, and map resize on tab switch for the dashboard.
- Restarted dashboard server on port 5001 after applying changes.
- Generated markdown snapshots for all code files under `/Users/byron/projects` at `/Users/byron/projects/docs/code-snapshots` using `scripts/export_code_snapshots.py`.
- Prepared commits for immunos-mcp and projects repo with dashboard updates and code snapshot exports.
- Added Spleen Summary panel + `/api/spleen/summary` for global anomaly triage.
- Added Agent Foundry (Bone Marrow) UI + `/api/agents/templates` + `/api/agents/foundry` endpoints.
- Added KB pages for immune-system feature map, IMMUNOS MVP, and references.
- Added presentation drafts under `docs/presentations/`.
- Added KB access in the monitor (list + markdown viewer).
- Updated dashboard review + phased plan to reflect new features.
- Restarted dashboard server on port 5001 after UI/API updates.
- Removed `immunos-mcp` from the tracked repo and kept IMMUNOS as the primary project name (package name remains `immunos_mcp`).
- Fixed Spleen Summary 500s by ensuring API DB connections are initialized and missing tables return empty counts.
- Vendorized Tailwind/Chart.js/Socket.IO locally under `scripts/static/vendor` for offline use and updated templates to load local assets.
- Replaced Tailwind `@apply` usage in the monitor with explicit CSS to ensure styles render without build tooling.
- Hardened dashboard JS against XSS by escaping API data and removing inline `onclick` handlers in monitor scripts.
- Throttled the orchestrator map render loop to only animate when the map tab is active.
- Added `scripts/immunos_training_eval.py` and generated `docs/training-eval-2025-12-22.md` with backend accuracy checks (hallucination, research, network).
- Updated training evaluation tooling for SciFact train/dev split, optional class balancing, and skip flags; generated `docs/training-eval-2025-12-22-research.md`.
- Added Ollama embedder (`immunos_mcp/embeddings/ollama_embedder.py`) and research training/eval CLI options to use local embeddings.
- Added `--research-nk-threshold` and `--research-nk-detectors` options to `scripts/immunos_training_eval.py`.
- Ran research eval with Ollama `nomic-embed-text` and NK threshold tuning:
  - `docs/training-eval-2025-12-22-research-ollama-nk075.md` (NK detectors generated: 0/200)
  - `docs/training-eval-2025-12-22-research-ollama-nk095.md` (NK accuracy 54%, precision 57%, recall 88%)
- Added SciFact evidence augmentation support and enhanced NK options for research eval + training.
- Research eval sweep (Ollama `nomic-embed-text`, balanced, include unknown):
  - `docs/training-eval-2025-12-22-research-ollama-nk090.md` (NK 52.0%)
  - `docs/training-eval-2025-12-22-research-ollama-nk095-v2.md` (NK 54.0%)
  - `docs/training-eval-2025-12-22-research-ollama-nk098.md` (NK 53.7%)
  - `docs/training-eval-2025-12-22-research-ollama-nk-enhanced.md` (Enhanced NK 41.3%; 0% precision/recall)
  - `docs/training-eval-2025-12-22-research-ollama-evidence.md` (B Cell 69.7% with evidence; NK 53.7%)
- Refreshed code snapshots under `/Users/byron/projects/docs/code-snapshots` for all code files.
- Added B Cell affinity/embedding-weight controls to `BCellAgent`, research training, and training eval.
- Added research eval options for B Cell strategy (sha/rha), evidence/corpus inputs, and NK mode.
- Pulled Ollama embedder `mxbai-embed-large` for stronger research embeddings.
- Research eval highlights:
  - `docs/training-eval-2025-12-22-research-ollama-evidence-embed.md` (embedding-only B Cell dropped to 36.0%)
  - `docs/training-eval-2025-12-22-research-ollama-evidence-hybrid09.md` (B Cell 54.3%)
  - `docs/training-eval-2025-12-22-research-ollama-evidence-rha.md` (B Cell 69.7%)
  - `docs/training-eval-2025-12-22-research-ollama-evidence-unbalanced.md` (B Cell 41.3%)
  - `docs/training-eval-2025-12-22-research-ollama-mxbai-evidence.md` (B Cell 70.7%)
  - `docs/training-eval-2025-12-22-research-ollama-mxbai-evidence5.md` (B Cell 70.7%)
- Trained research agents with mxbai embeddings + evidence and saved:
  - `.immunos/agents/research_bcell_mxbai.json`
  - `.immunos/agents/research_nk_mxbai.json`
- Refreshed code snapshots after research training updates.
- Updated `docs/training.md` with a recommended evidence-augmented research training command using mxbai embeddings.
- Added macro precision/recall/F1 metrics for research B Cell evaluation and label-count reporting in training eval.
- Added SciFact test evaluation option with warnings when test labels are single-class; updated `docs/training.md`.
- Generated `/Users/byron/projects/docs/training-eval-2025-12-22-research-ollama-mxbai-evidence-test.md` with dev + test splits.
- Refreshed code snapshots after evaluation updates.
- Added stratified k-fold evaluation for research (train+dev) with macro metrics reporting.
- Added evidence retrieval augmentation (cited-doc sentence retrieval) for research training/eval with candidate caps.
- Added CLI flags for evidence modes and retrieval candidate limits in training/eval.
- Pulled `bge-m3` embedder and benchmarked against mxbai:
  - `docs/training-eval-2025-12-22-research-ollama-mxbai-kfold.md` (5-fold balanced)
  - `docs/training-eval-2025-12-22-research-ollama-mxbai-kfold-retrieval.md` (3-fold retrieval, candidates/doc=5)
  - `docs/training-eval-2025-12-22-research-ollama-bge-m3-kfold.md` (3-fold balanced)
- Refreshed code snapshots after retrieval + k-fold updates.
- Ran final publication-grade k-fold (gold evidence + mxbai, 5-fold balanced): `docs/training-eval-2025-12-22-research-ollama-mxbai-kfold-final.md`.
- Trained final research agents (gold evidence + mxbai) and saved:
  - `.immunos/agents/research_bcell_mxbai_gold.json`
  - `.immunos/agents/research_nk_mxbai_gold.json`
- Added TODO to replicate baseline results from related AIS/SciFact papers (TODO-20251223-001).
- Refreshed code snapshots after final k-fold + training runs.
- Added `docs/immunos-references.md` with DOI links, SciFact baseline sources, and reproducibility pointers.
- Added NegSl-AIS baseline details (DOI, dataset, metrics, local paths) to `docs/immunos-references.md`.
- Added baseline summary: `docs/reference/negsl-ais-2025-baseline.md`.
- Checked Claude context files (`/Users/byron/projects/.claude`, `/Users/byron/projects/claude.md`) for references; no DOI entries to add.
- Exported NegSl-AIS reference list (DOI-only) for Zotero import: `research/citations/immunos-references.bib`.
- Added reproducibility checklist to `docs/reference/negsl-ais-2025-baseline.md`.
- Updated reference index to point to Zotero BibTeX file.
- Added SciFact baseline replication log with preflight dependency check and run commands: `docs/reference/scifact-baseline-replication.md`.
- Updated `.claude` and `claude.md` with publication preferences (Zotero + journal logging).
- Updated NegSl-AIS BibTeX with confirmed DOI `10.3390/s23031598` and removed alternate candidates.
- Added the confirmed DOI entry to the non-BibTeX publications log.
- SciFact baseline replication blocked on Python 3.7/3.8 requirement (system Python 3.9; conda missing).
- Added non-BibTeX publications log for ongoing tracking: `docs/reference/publications-log.md`.
- Installed pyenv and Python 3.8.18; created SciFact venv at `data/immunos_data/research/scifact/.venv`.
- SciFact requirements install failed on arm64 at `numpy==1.18.2` (`-faltivec` clang error); Cython installed.
- Attempted x86_64 Python 3.8.18 via pyenv + Rosetta with separate root; build did not complete.
